<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		 <style>
        /* Color Variables */
        :root {
            /* Android green */
            --android-green: #a4c639;
            --android-green-dark: #8aac2f;
            
            /* Antique brass */
            --antique-brass: #cd9575;
            --antique-brass-dark: #b58262;
            
            /* Antique bronze */
            --antique-bronze: #665d1e;
            --antique-bronze-light: #8c7d2a;
            
            /* Antique fuchsia */
            --antique-fuchsia: #915c83;
            --antique-fuchsia-dark: #7d4f71;
            
            /* Black and white */
            --black: #000000;
            --white: #ffffff;
            
            /* Theme Variables - Light Mode */
            --primary: var(--android-green);
            --primary-dark: var(--android-green-dark);
            --secondary: var(--antique-brass);
            --secondary-dark: var(--antique-brass-dark);
            --danger: var(--antique-fuchsia);
            --danger-dark: var(--antique-fuchsia-dark);
            --warning: var(--antique-bronze);
            --warning-light: var(--antique-bronze-light);
            --dark: var(--black);
            --light: var(--white);
            --gray: #f5f5f5;
            --dark-gray: #d0d0d0;
            --border: #e0e0e0;
            --text: #333333;
            --text-light: #666666;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
            
            /* Theme-specific backgrounds */
            --body-bg: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
            --container-bg: var(--light);
            --section-bg: var(--gray);
            --header-bg: linear-gradient(to right, var(--primary), var(--primary-dark));
            --status-bg: var(--gray);
            --footer-bg: transparent;
            --output-bg: var(--light);
            --match-bg: var(--light);
            --tooltip-bg: var(--dark);
            --table-header-bg: var(--primary);
            --table-row-even: #f8f9fa;
            --table-row-hover: #e3f2fd;
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --primary: var(--android-green);
            --primary-dark: var(--android-green-dark);
            --secondary: var(--antique-brass);
            --secondary-dark: var(--antique-brass-dark);
            --danger: var(--antique-fuchsia);
            --danger-dark: var(--antique-fuchsia-dark);
            --warning: var(--antique-bronze);
            --warning-light: var(--antique-bronze-light);
            --dark: var(--white);
            --light: #1e1e1e;
            --gray: #2d2d2d;
            --dark-gray: #444444;
            --border: #444444;
            --text: #e0e0e0;
            --text-light: #a0a0a0;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            
            /* Theme-specific backgrounds */
            --body-bg: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            --container-bg: #252525;
            --section-bg: #2d2d2d;
            --header-bg: linear-gradient(to right, var(--primary), var(--primary-dark));
            --status-bg: #333333;
            --footer-bg: transparent;
            --output-bg: #2a2a2a;
            --match-bg: #2d2d2d;
            --tooltip-bg: #333333;
            --table-header-bg: var(--primary);
            --table-row-even: #333333;
            --table-row-hover: #3a3a3a;
        }

        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--body-bg);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            transition: var(--transition);
        }
        
        .dictionary-manager-container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--container-bg);
            border-radius: 12px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: var(--transition);
        }
        
        .dictionary-manager-header {
            background: var(--header-bg);
            color: var(--light);
            padding: 30px;
            text-align: center;
            transition: var(--transition);
        }
        
        .dictionary-manager-title {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: var(--transition);
        }
        
        .dictionary-manager-title svg {
            width: 48px;
            height: 48px;
            fill: var(--light);
            transition: var(--transition);
        }
        
        .dictionary-manager-description {
            max-width: 800px;
            margin: 20px auto 0;
            font-size: 1.1rem;
            opacity: 0.9;
            line-height: 1.8;
            transition: var(--transition);
        }
        
        .dictionary-manager-main {
            padding: 30px;
            transition: var(--transition);
        }
        
        .dictionary-manager-section {
            background: var(--section-bg);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }
        
        .dictionary-manager-section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--dark);
            font-size: 1.5rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
            transition: var(--transition);
        }
        
        .dictionary-manager-section-title svg {
            width: 28px;
            height: 28px;
            fill: var(--primary);
            transition: var(--transition);
        }
        
        .dictionary-manager-input-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .dictionary-manager-input-box {
            flex: 1;
            min-width: 300px;
        }
        
        .dictionary-manager-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }
        
        .dictionary-manager-label svg {
            width: 20px;
            height: 20px;
            fill: var(--primary);
            transition: var(--transition);
        }
        
        .dictionary-manager-select,
        .dictionary-manager-textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--container-bg);
            color: var(--text);
        }
        
        .dictionary-manager-select:focus,
        .dictionary-manager-textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);
        }
        
        .dictionary-manager-textarea {
            height: 150px;
            resize: vertical;
        }
        
        .dictionary-manager-file-input {
            width: 100%;
            padding: 12px;
            background: var(--container-bg);
            border: 2px dashed var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text);
        }
        
        .dictionary-manager-file-input:hover {
            border-color: var(--primary);
            background-color: var(--section-bg);
        }
        
        .dictionary-manager-tabs {
            display: flex;
            background: var(--container-bg);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            transition: var(--transition);
        }
        
        .dictionary-manager-tab-btn {
            flex: 1;
            padding: 20px;
            text-align: center;
            background: var(--section-bg);
            border: none;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            color: var(--dark);
            position: relative;
        }
        
        .dictionary-manager-tab-btn:hover {
            background: var(--gray);
        }
        
        .dictionary-manager-tab-btn.active {
            background: var(--primary);
            color: var(--light);
        }
        
        .dictionary-manager-tab-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
            transition: var(--transition);
        }
        
        .dictionary-manager-tab-content {
            display: none;
            padding: 25px;
            background: var(--container-bg);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: var(--transition);
        }
        
        .dictionary-manager-tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .dictionary-manager-button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .dictionary-manager-btn {
            padding: 14px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .dictionary-manager-btn:after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(-100%);
            transition: transform 0.4s ease;
        }
        
        .dictionary-manager-btn:hover:after {
            transform: translateX(100%);
        }
        
        .dictionary-manager-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        
        .dictionary-manager-btn svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
            transition: var(--transition);
        }
        
        .dictionary-manager-btn-primary {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: var(--light);
        }
        
        .dictionary-manager-btn-secondary {
            background: linear-gradient(to right, var(--secondary), var(--secondary-dark));
            color: var(--light);
        }
        
        .dictionary-manager-btn-danger {
            background: linear-gradient(to right, var(--danger), var(--danger-dark));
            color: var(--light);
        }
        
        .dictionary-manager-btn-warning {
            background: linear-gradient(to right, var(--warning), var(--warning-light));
            color: var(--light);
        }
        
        .dictionary-manager-btn-light {
            background: var(--container-bg);
            color: var(--dark);
            border: 1px solid var(--border);
        }
        
        .dictionary-manager-output {
            margin-top: 15px;
            border: 1px solid var(--border);
            padding: 20px;
            border-radius: 8px;
            background: var(--output-bg);
            overflow-y: auto;
            max-height: 400px;
            min-height: 150px;
            font-family: monospace;
            white-space: pre-wrap;
            line-height: 1.8;
            transition: var(--transition);
        }
        
        .dictionary-manager-status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-weight: 500;
            text-align: center;
            background: var(--status-bg);
            border: 1px solid var(--border);
            transition: var(--transition);
        }
        
        .dictionary-manager-hidden {
            display: none;
        }
        
        /* Tooltip styles */
        .dictionary-manager-tooltip {
            position: relative;
        }
        
        .dictionary-manager-tooltip .dictionary-manager-tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--tooltip-bg);
            color: var(--light);
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .dictionary-manager-tooltip .dictionary-manager-tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--tooltip-bg) transparent transparent transparent;
        }
        
        .dictionary-manager-tooltip:hover .dictionary-manager-tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .dictionary-manager-footer {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
            border-top: 1px solid var(--border);
            background: var(--footer-bg);
            transition: var(--transition);
        }
        
        .dictionary-manager-matches {
            margin-top: 20px;
            padding: 15px;
            background-color: var(--section-bg);
            border-radius: 8px;
            border: 1px solid var(--border);
        }
        
        .dictionary-manager-match {
            padding: 8px;
            margin-bottom: 10px;
            background-color: var(--match-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid var(--border);
            transition: all 0.2s ease;
            display: table-row;
            border-bottom: 1px solid var(--border);
        }
        
        .dictionary-manager-match:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }
        
        .dictionary-manager-match-header {
            padding-bottom: 5px;
            margin-bottom: 8px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            width: 25%;
            font-weight: 600;
            border-right: 1px solid var(--border);
        }
        
        .dictionary-manager-match-header strong {
            font-size: 1.1rem;
            color: var(--dark);
            flex-grow: 1;
        }
        
        .dictionary-manager-match-options {
            display: block !important;
            grid-template-columns: none !important;
            gap: 0 !important;
        }
        
        .dictionary-manager-match-option {
            padding: 6px;
            margin-bottom: 5px;
            border-radius: 4px;
            background-color: var(--section-bg);
            border: 1px solid var(--border);
        }
        
        .dictionary-manager-match-option label {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
            font-weight: 500;
            cursor: pointer;
            color: var(--text);
        }
        
        .dictionary-manager-match-option input[type="radio"] {
            margin-top: 5px;
        }
        
        .dictionary-manager-match-value {
            min-height: 40px;
            padding: 5px;
            font-size: 0.9em;
            background: var(--container-bg);
            border: 1px solid var(--border);
            border-radius: 4px;
            overflow: auto;
            line-height: 1.4;
            margin-top: 5px;
            color: var(--text);
        }
        
        .dictionary-manager-custom-value {
            font-family: inherit;
            resize: vertical;
            min-height: 40px;
            padding: 5px;
            font-size: 0.9em;
            width: 100%;
            border: 1px solid var(--border);
            border-radius: 4px;
            margin-top: 5px;
            background: var(--container-bg);
            color: var(--text);
        }
        
        .dictionary-manager-custom-value:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        #dictionary-manager-confirmBtn {
            margin-top: 20px;
            width: 100%;
            padding: 14px;
            font-size: 1.1rem;
        }
        
        .dictionary-manager-entry-actions {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        
        .dictionary-manager-entry-btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }
        
        .dictionary-manager-entry-save {
            background-color: var(--secondary);
            color: var(--light);
        }
        
        .dictionary-manager-entry-delete {
            background-color: var(--danger);
            color: var(--light);
        }
        
        .dictionary-manager-entry-edit {
            background-color: var(--primary);
            color: var(--light);
        }
        
        .dictionary-manager-entry-value {
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            min-height: 40px;
            background: var(--container-bg);
            color: var(--text);
        }
        
        .dictionary-manager-editable {
            background-color: var(--section-bg);
            border: 1px solid var(--warning);
        }
        
        .dictionary-manager-edit-input {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border);
            border-radius: 4px;
            font-family: inherit;
            font-size: 1rem;
            background: var(--container-bg);
            color: var(--text);
        }
        
        .dictionary-manager-summary {
            margin: 10px 0;
            padding: 10px;
            background-color: var(--section-bg);
            border-radius: 6px;
            border: 1px solid var(--border);
            font-weight: 500;
            color: var(--text);
        }
        
        .dictionary-manager-merge-info {
            margin-top: 10px;
            padding: 10px;
            background-color: var(--primary);
            opacity: 0.1;
            border-radius: 6px;
            border: 1px solid var(--border);
            color: var(--text);
        }
        
        .dictionary-manager-matches-container {
            display: table;
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .dictionary-manager-match-header,
        .dictionary-manager-match-options {
            display: table-cell;
            padding: 8px 8px;
            vertical-align: top;
        }
        
        .dictionary-manager-match-options {
            width: 75%;
        }
        
        .dictionary-manager-match-option:last-child {
            margin-bottom: 0;
        }
        
        .dictionary-manager-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .dictionary-manager-search {
            flex: 1;
            min-width: 200px;
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--container-bg);
            color: var(--text);
        }
        
        .dictionary-manager-search:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);
        }
        
        .dictionary-manager-filter {
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--container-bg);
            cursor: pointer;
            transition: var(--transition);
            color: var(--text);
        }
        
        .dictionary-manager-filter:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);
        }
        
        .dictionary-manager-entry-hidden {
            display: none;
        }
        
        .dictionary-manager-subsection-title {
            font-size: 1.3rem;
            margin-top: 25px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--primary);
        }
        
        .dictionary-manager-suggestions-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .dictionary-manager-suggestions-table th {
            background-color: var(--table-header-bg);
            color: var(--light);
            text-align: left;
            padding: 10px;
        }
        
        .dictionary-manager-suggestions-table td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
            color: var(--text);
        }
        
        .dictionary-manager-suggestions-table tr:nth-child(even) {
            background-color: var(--table-row-even);
        }
        
        .dictionary-manager-suggestions-table tr:hover {
            background-color: var(--table-row-hover);
        }
        
        /* Theme Toggle */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--section-bg);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 100;
        }
        
        .theme-toggle svg {
            width: 20px;
            height: 20px;
            fill: var(--text);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .dictionary-manager-input-group {
                flex-direction: column;
            }
            
            .dictionary-manager-button-group {
                flex-direction: column;
            }
            
            .dictionary-manager-btn {
                width: 100%;
            }
            
            .dictionary-manager-tabs {
                flex-direction: column;
            }
            
            .dictionary-manager-header {
                padding: 20px 15px;
            }
            
            .dictionary-manager-main {
                padding: 20px 15px;
            }
            
            .dictionary-manager-title {
                font-size: 2rem;
            }
        }
    </style>
		<title>.po File Dictionary Manager</title>
	</head>
	<body>
		<div class="dictionary-manager-container">
			<header class="dictionary-manager-header">
				<h1 class="dictionary-manager-title">
					<svg viewBox="0 0 24 24">
						<path d="M0 0h24v24H0z" fill="none"/>
						<path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"/>
					</svg>
					.po File Dictionary Manager
				</h1>
				<p class="dictionary-manager-description">
					This tool helps you manage and translate .po files efficiently. 
					Upload your .po files or paste content directly, then use the dictionary 
					tools to extract, manage, and apply translations. All processing happens 
					locally in your browser - no data is sent to any server.
				</p>
			</header>
			
			<main class="dictionary-manager-main">
				<div class="dictionary-manager-section">
					<h2 class="dictionary-manager-section-title">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
						</svg>
						Load .po File
					</h2>
					
					<div class="dictionary-manager-input-group">
						<div class="dictionary-manager-input-box">
							<label class="dictionary-manager-label" for="dictionary-manager-fileInput">
								<svg viewBox="0 0 24 24">
									<path d="M0 0h24v24H0z" fill="none"/>
									<path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
								</svg>
								Upload .po File(s)
							</label>
							<input type="file" id="dictionary-manager-fileInput" multiple accept=".po" class="dictionary-manager-file-input">
						</div>
						
						<div class="dictionary-manager-input-box">
							<label class="dictionary-manager-label" for="dictionary-manager-poContent">
								<svg viewBox="0 0 24 24">
									<path d="M0 0h24v24H0z" fill="none"/>
									<path d="M19 2h-4.18C14.4.84 13.3 0 12 0c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 18H5V4h2v3h10V4h2v16z"/>
								</svg>
								Or Paste .po Content
							</label>
							<textarea id="dictionary-manager-poContent" placeholder="Paste .po file content here..." class="dictionary-manager-textarea"></textarea>
						</div>
					</div>
					
					<div class="dictionary-manager-input-group">
						<div class="dictionary-manager-input-box">
							<label class="dictionary-manager-label" for="dictionary-manager-language">
								<svg viewBox="0 0 24 24">
									<path d="M0 0h24v24H0z" fill="none"/>
									<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
								</svg>
								Target Language
							</label>
							<select id="dictionary-manager-language" class="dictionary-manager-select">
								<option value="en_GB">British English</option>
								<option value="it">Italian</option>
								<option value="cs">Czech</option>
								<option value="de">German</option>
								<option value="ar" selected>Arabic</option>
								<option value="ja">Japanese</option>
								<option value="sk">Slovak</option>
								<option value="zh_CN">Chinese (Simplified)</option>
								<option value="tr">Turkish</option>
								<option value="fr">French</option>
								<option value="es">Spanish</option>
								<option value="ru">Russian</option>
								<option value="fi">Finnish</option>
								<option value="pt_BR">Brazilian Portuguese</option>
								<option value="zh_TW">Chinese (Taiwan)</option>
								<option value="pl">Polish</option>
								<option value="bg">Bulgarian</option>
								<option value="hu">Hungarian</option>
								<option value="ca">Catalan</option>
								<option value="gl">Galician</option>
								<option value="pt">Portuguese</option>
								<option value="vi">Vietnamese</option>
								<option value="id">Indonesian</option>
								<option value="et">Estonian</option>
								<option value="uk">Ukrainian</option>
								<option value="sv">Swedish</option>
								<option value="lt">Lithuanian</option>
								<option value="sr">Serbian</option>
								<option value="eo">Esperanto</option>
								<option value="da">Danish</option>
								<option value="ko">Korean</option>
								<option value="la">Latin</option>
								<option value="nl">Dutch</option>
								<option value="gd">Scottish Gaelic</option>
								<option value="el">Greek</option>
								<option value="nb_NO">Norwegian</option>
								<option value="en@shaw">English (Shavian characters)</option>
								<option value="ga">Irish</option>
								<option value="racv">RACV Language</option>
								<option value="bn">Bengali</option>
								<option value="lv">Latvian</option>
								<option value="af">Afrikaans</option>
								<option value="he">Hebrew</option>
								<option value="is">Icelandic</option>
								<option value="sl">Slovenian</option>
								<option value="eu">Basque</option>
								<option value="ang@latin">Old English (Latin characters)</option>
								<option value="hr">Croatian</option>
								<option value="ca_ES@valencia">Valencian (Southern Catalan)</option>
								<option value="tl">Filipino</option>
								<option value="grc">Ancient Greek</option>
								<option value="mr">Marathi</option>
								<option value="mk">Macedonian</option>
								<option value="ro">Romanian</option>
								<option value="cy">Welsh</option>
								<option value="es_419">Spanish (Latin American)</option>
								<option value="my">Burmese</option>
							</select>
						</div>
						
						<div class="dictionary-manager-input-box">
							<label class="dictionary-manager-label" for="dictionary-manager-wordCount">
								<svg viewBox="0 0 24 24">
									<path d="M0 0h24v24H0z" fill="none"/>
									<path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/>
								</svg>
								Processing Options
							</label>
							<select id="dictionary-manager-wordCount" class="dictionary-manager-select">
								<option value="1">Single word only</option>
								<option value="2">Two words only</option>
								<option value="both">Both single and two words</option>
							</select>
						</div>
					</div>
				</div>
				
				<div class="dictionary-manager-tabs">
					<button class="dictionary-manager-tab-btn active" data-tab="dictionary-management">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"/>
						</svg>
						Dictionary Management
					</button>
					<button class="dictionary-manager-tab-btn" data-tab="po-file-management">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
						</svg>
						PO File Management
					</button>
				</div>
				
				<div id="dictionary-management" class="dictionary-manager-tab-content active">
					<h2 class="dictionary-manager-section-title">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/>
						</svg>
						Dictionary Tools
					</h2>
					
					<div class="dictionary-manager-button-group">
						<button id="dictionary-manager-processBtn" class="dictionary-manager-btn dictionary-manager-btn-primary dictionary-manager-tooltip">
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M15.55 13c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.37-.66-.11-1.48-.87-1.48H5.21l-.94-2H1v2h2l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h12v-2H7l1.1-2h7.45zM6.16 6h12.15l-2.76 5H8.53L6.16 6zM7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
							</svg>
							Process Files
							<span class="dictionary-manager-tooltiptext">Extract dictionary entries from loaded .po files</span>
						</button>
						
						<button id="dictionary-manager-downloadBtn" class="dictionary-manager-btn dictionary-manager-btn-secondary dictionary-manager-tooltip" disabled>
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
							</svg>
							Download Dictionary
							<span class="dictionary-manager-tooltiptext">Download dictionary as JSON file</span>
						</button>
						
						<button id="dictionary-manager-uploadDictBtn" class="dictionary-manager-btn dictionary-manager-btn-light dictionary-manager-tooltip">
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"/>
							</svg>
							Upload Dictionary
							<span class="dictionary-manager-tooltiptext">Upload a previously saved dictionary</span>
						</button>
						
						<button id="dictionary-manager-saveDictBtn" class="dictionary-manager-btn dictionary-manager-btn-light dictionary-manager-tooltip">
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
							</svg>
							Save Dictionary
							<span class="dictionary-manager-tooltiptext">Save dictionary to browser storage</span>
						</button>
						<button id="dictionary-manager-loadBtn" class="dictionary-manager-btn dictionary-manager-btn-light dictionary-manager-tooltip">
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
							</svg>
							Load Dictionary
							<span class="dictionary-manager-tooltiptext">Load dictionary for selected language</span>
						</button>
						<button id="dictionary-manager-clearDictBtn" class="dictionary-manager-btn dictionary-manager-btn-danger dictionary-manager-tooltip">
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
							</svg>
							Clear Dictionary
							<span class="dictionary-manager-tooltiptext">Remove all dictionary entries</span>
						</button>
					</div>
					
					<h3 class="dictionary-manager-section-title" style="font-size: 1.3rem;">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
						</svg>
						Dictionary Output
					</h3>
					<div class="dictionary-manager-controls">
						<button id="dictionary-manager-newEntryBtn" class="dictionary-manager-btn dictionary-manager-btn-secondary">
							New Entry
						</button>
						<input type="text" id="dictionary-manager-searchInput" class="dictionary-manager-search" placeholder="Search dictionary...">
						<select id="dictionary-manager-filterSelect" class="dictionary-manager-filter">
							<option value="all">All Entries</option>
							<option value="a-c">A-C</option>
							<option value="d-f">D-F</option>
							<option value="g-i">G-I</option>
							<option value="j-l">J-L</option>
							<option value="m-o">M-O</option>
							<option value="p-r">P-R</option>
							<option value="s-u">S-U</option>
							<option value="v-z">V-Z</option>
						</select>
					</div>
					<div id="dictionary-manager-dictionaryOutput" class="dictionary-manager-output">
						<p>Processed dictionary entries will appear here...</p>
					</div>
				</div>
				
				<!-- Only showing the modified PO File Management section -->
				<div id="po-file-management" class="dictionary-manager-tab-content">
					<h2 class="dictionary-manager-section-title">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
						</svg>
						.po File Tools
					</h2>
					
					<div class="dictionary-manager-button-group">
						<button id="dictionary-manager-applyDictBtn" class="dictionary-manager-btn dictionary-manager-btn-primary dictionary-manager-tooltip">
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
							</svg>
							Apply Dictionary
							<span class="dictionary-manager-tooltiptext">Apply dictionary to current .po file</span>
						</button>
						
						<button id="dictionary-manager-downloadModifiedBtn" class="dictionary-manager-btn dictionary-manager-btn-secondary dictionary-manager-tooltip" disabled>
							<svg viewBox="0 0 24 24">
								<path d="M0 0h24v24H0z" fill="none"/>
								<path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
							</svg>
							Download Modified .po
							<span class="dictionary-manager-tooltiptext">Download modified .po file</span>
						</button>
					</div>
					
					<div class="dictionary-manager-input-group">
						<div class="dictionary-manager-input-box">
							<label class="dictionary-manager-label" for="dictionary-manager-applyMode">
								<svg viewBox="0 0 24 24">
									<path d="M0 0h24v24H0z" fill="none"/>
									<path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
								</svg>
								Apply Mode
							</label>
							<select id="dictionary-manager-applyMode" class="dictionary-manager-select">
								<option value="suggest">Suggest Modifications</option>
								<option value="auto">Auto-Apply Modifications</option>
							</select>
						</div>
					</div>
					
					<!-- New Suggestion Table Area -->
					<h3 class="dictionary-manager-section-title dictionary-manager-subsection-title">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"/>
						</svg>
						Translation Suggestions
					</h3>
					<div id="dictionary-manager-suggestionsOutput" class="dictionary-manager-output">
						<p>Translation suggestions will appear here after applying the dictionary...</p>
					</div>
					
					<h3 class="dictionary-manager-section-title dictionary-manager-subsection-title">
						<svg viewBox="0 0 24 24">
							<path d="M0 0h24v24H0z" fill="none"/>
							<path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
						</svg>
						Modified .po Output
					</h3>
					<div id="dictionary-manager-applicationOutput" class="dictionary-manager-output">
						<p>Modified .po content will appear here...</p>
					</div>
				</div>
				
				<div id="dictionary-manager-status" class="dictionary-manager-status">
					Ready to process .po files
				</div>
			</main>
			
			<footer class="dictionary-manager-footer">
				<p>All processing happens locally in your browser - no data is sent to any server</p>
				<p>.po File Dictionary Manager &copy; 2023</p>
			</footer>
		</div>
		
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				const processBtn = document.getElementById('dictionary-manager-processBtn');
				const fileInput = document.getElementById('dictionary-manager-fileInput');
				const poContentTextarea = document.getElementById('dictionary-manager-poContent');
				const statusDiv = document.getElementById('dictionary-manager-status');
				const loadBtn = document.getElementById('dictionary-manager-loadBtn');
				const saveDictBtn = document.getElementById('dictionary-manager-saveDictBtn');
				const downloadBtn = document.getElementById('dictionary-manager-downloadBtn');
				const clearDictBtn = document.getElementById('dictionary-manager-clearDictBtn');
				const uploadDictBtn = document.getElementById('dictionary-manager-uploadDictBtn');
				const tabBtns = document.querySelectorAll('.dictionary-manager-tab-btn');
				const tabContents = document.querySelectorAll('.dictionary-manager-tab-content');
				const applyDictBtn = document.getElementById('dictionary-manager-applyDictBtn');
				if (applyDictBtn) {
					applyDictBtn.addEventListener('click', applyDictionary);
				}
				const downloadModifiedBtn = document.getElementById('dictionary-manager-downloadModifiedBtn');
				if (downloadModifiedBtn) {
					downloadModifiedBtn.addEventListener('click', downloadModifiedPo);
					downloadModifiedBtn.disabled = false;
				}
				
				// Global variable to track current dictionary
				let currentDictionary = null;
				// global variable to store original content
				let originalPoContent = '';
				
				tabBtns.forEach(btn => {
					btn.addEventListener('click', () => {
						const tabId = btn.dataset.tab;
						
						// Remove active class from all buttons and contents
						tabBtns.forEach(b => b.classList.remove('active'));
						tabContents.forEach(c => c.classList.remove('active'));
						
						// Add active class to clicked button and corresponding content
						btn.classList.add('active');
						document.getElementById(tabId).classList.add('active');
					});
				});
				// Function to load dictionary for selected language
				function loadDictionary() {
					const language = document.getElementById('dictionary-manager-language').value;
					const dictKey = `dictionary-${language}`;
					const storedDict = localStorage.getItem(dictKey);
					
					if (storedDict) {
						try {
							currentDictionary = JSON.parse(storedDict);
							renderDictionary(currentDictionary);
							statusDiv.textContent = `Loaded dictionary for ${language} with ${Object.keys(currentDictionary.entries).length} entries`;
							} catch (e) {
							statusDiv.textContent = `Error loading dictionary: Invalid format`;
							console.error('Dictionary parse error:', e);
						}
						} else {
						statusDiv.textContent = `No dictionary found for ${language}`;
						document.getElementById('dictionary-manager-dictionaryOutput').innerHTML = 
					`<p>No dictionary exists for ${language}. Create one by processing .po files.</p>`;
					}
					}
					async function getPoContent() {
					if (poContentTextarea.value.trim() !== '') {
					return poContentTextarea.value;
					}
					
					if (fileInput.files.length > 0) {
					const file = fileInput.files[0];
					return new Promise((resolve, reject) => {
					const reader = new FileReader();
					reader.onload = (e) => resolve(e.target.result);
					reader.onerror = (e) => reject(new Error('File reading error'));
					reader.readAsText(file);
					});
					}
					
					return null;
					}
					
					function extractHeader(content) {
					const lines = content.split(/\r?\n/);
					let headerEnd = 0;
					
					for (let i = 0; i < lines.length; i++) {
					if (lines[i].trim() === '') {
					headerEnd = i;
					break;
					}
					}
					
					return {
					header: lines.slice(0, headerEnd + 1).join('\n'),
					message: `Header extracted (${headerEnd + 1} lines)`
					};
					}
					
					function extractLanguageLine(header) {
					const regex = /Language:\s*([^\n]+)/i;
					const match = header.match(regex);
					if (match && match[1]) {
					console.log(`Extracted language line: ${match[0]}`);
					return match[1].trim();
					}
					console.log('No language line found in header');
					return null;
					}
					
					function cleanLanguageCode(languageLine) {
					// Remove newlines first
					let cleaned = languageLine.replace(/\n/g, '');
					
					// Find the position of the backslash
					const backslashIndex = cleaned.indexOf('\\');
					
					// If backslash is found, remove it and everything after it
					if (backslashIndex !== -1) {
					cleaned = cleaned.substring(0, backslashIndex);
					}
					
					// Remove any quotes and trim whitespace
					cleaned = cleaned.replace(/['"]/g, '').trim();
					console.log(`Cleaned language code: ${cleaned}`);
					return cleaned;
					}
					function parsePoEntries(content) {
					const entries = [];
					const blocks = content.split(/\n\n/);
					
					for (const block of blocks) {
					if (!block.trim()) continue;
					
					// Skip blocks with continuation lines (multi-line entries)
					if (block.includes('\n"') || block.includes('\n#~ "')) {
					continue;
					}
					
					const msgidMatch = block.match(/(?:#~ *)?msgid\s+"(.*?[^\\])"/);
					if (!msgidMatch) continue;
					
					const msgstrMatch = block.match(/(?:#~ *)?msgstr\s+"(.*?[^\\])"/);
					const msgid = msgidMatch[1].replace(/\\"/g, '"').trim();
					const msgstr = msgstrMatch ? msgstrMatch[1].replace(/\\"/g, '"').trim() : "";
					
					// Skip empty/invalid msgid values
					if (!msgid || 
					msgid === "\\n" || 
					msgid === "\\t" || 
					msgid === "\\r" || 
					msgid === '""' || 
					msgid === '') {
					continue;
					}
					
					entries.push({ msgid, msgstr });
					}
					
					return entries;
					}
					
					function createDictionaryContainer(languagePo) {
					const wordCount = document.getElementById('dictionary-manager-wordCount').value;
					const dictionary = {
					metadata: {
					language: languagePo,
					wordCount: wordCount,
					created: new Date().toISOString(),
					modified: new Date().toISOString(),
					version: "1.0",
					source: "po-file-extractor"
					},
					entries: {}
					};
					localStorage.setItem(`dictionary-${languagePo}`, JSON.stringify(dictionary));
					return dictionary;
					}
					
					function processDictionaryMatches(dictionary, entries) {
					const matches = [];
					
					for (const entry of entries) {
					if (dictionary.entries[entry.msgid] !== undefined) {
					matches.push({
					msgid: entry.msgid,
					existing: dictionary.entries[entry.msgid],
					new: entry.msgstr
					});
					}
					}
					
					return matches;
					}
					
					function renderDictionary(dictionary) {
					const outputDiv = document.getElementById('dictionary-manager-dictionaryOutput');
					const entries = dictionary.entries;
					const entryCount = Object.keys(entries).length;
					
					let html = `
					<div class="dictionary-manager-summary">
						Dictionary: ${dictionary.metadata.language} | 
						Entries: ${entryCount} | 
						Created: ${new Date(dictionary.metadata.created).toLocaleDateString()} |
						Modified: ${new Date(dictionary.metadata.modified).toLocaleDateString()}
					</div>
					<table style="width:100%; border-collapse:collapse; margin-top:10px;">
						<thead>
							<tr style="border-bottom:2px solid #3498db;">
								<th style="padding:8px;text-align:left;width:30%;">Key</th>
								<th style="padding:8px;text-align:left;width:50%;">Value</th>
								<th style="padding:8px;text-align:left;width:20%;">Actions</th>
							</tr>
						</thead>
						<tbody>
							`;
							
							for (const [key, value] of Object.entries(entries)) {
							html += `
							<tr data-key="${encodeURIComponent(key)}" style="border-bottom:1px solid #eee;">
								<td style="padding:8px;vertical-align:top;"><strong>${key}</strong></td>
								<td style="padding:8px;vertical-align:top;">
									<div class="dictionary-manager-entry-value">${value}</div>
								</td>
								<td style="padding:8px;">
									<div class="dictionary-manager-entry-actions">
										<button class="dictionary-manager-entry-btn dictionary-manager-entry-edit">Edit</button>
										<button class="dictionary-manager-entry-btn dictionary-manager-entry-delete">Delete</button>
									</div>
								</td>
							</tr>
							`;
							}
							
						html += `</tbody></table>`;
						outputDiv.innerHTML = html;
						
						// Add event listeners for edit buttons
						outputDiv.querySelectorAll('.dictionary-manager-entry-edit').forEach(btn => {
						btn.addEventListener('click', function() {
						const row = this.closest('tr');
						const key = decodeURIComponent(row.dataset.key);
						const valueCell = row.querySelector('.dictionary-manager-entry-value');
						const originalValue = currentDictionary.entries[key];
						
						valueCell.innerHTML = `
						<textarea class="dictionary-manager-edit-input">${originalValue}</textarea>
						<div class="dictionary-manager-entry-actions" style="margin-top:8px;">
							<button class="dictionary-manager-entry-btn dictionary-manager-entry-save">Save</button>
							<button class="dictionary-manager-entry-btn dictionary-manager-entry-cancel">Cancel</button>
						</div>
						`;
						
						// Focus and select text for editing
						const textarea = valueCell.querySelector('textarea');
						textarea.focus();
						textarea.select();
						
						// Save handler
						valueCell.querySelector('.dictionary-manager-entry-save').addEventListener('click', function() {
						const newValue = textarea.value.trim();
						if (newValue === '') {
						statusDiv.textContent = 'Error: Value cannot be empty';
						return;
						}
						
						currentDictionary.entries[key] = newValue;
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = `Updated entry: ${key.substring(0, 30)}${key.length > 30 ? '...' : ''}`;
						});
						
						// Cancel handler
						valueCell.querySelector('.dictionary-manager-entry-cancel').addEventListener('click', function() {
						renderDictionary(currentDictionary);
						});
						});
						});
						
						// Add event listeners for delete buttons
						outputDiv.querySelectorAll('.dictionary-manager-entry-delete').forEach(btn => {
						btn.addEventListener('click', function() {
						const row = this.closest('tr');
						const key = decodeURIComponent(row.dataset.key);
						
						if (confirm(`Delete entry for "${key.substring(0, 30)}${key.length > 30 ? '...' : ''}"?`)) {
						delete currentDictionary.entries[key];
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = `Deleted entry: ${key.substring(0, 30)}${key.length > 30 ? '...' : ''}`;
						}
						});
						});
						}
						// Save current dictionary to localStorage
						function saveCurrentDictionary() {
						if (currentDictionary) {
						currentDictionary.metadata.modified = new Date().toISOString();
						const dictKey = `dictionary-${currentDictionary.metadata.language}`;
						localStorage.setItem(dictKey, JSON.stringify(currentDictionary));
						}
						}
						
						// Download current dictionary
						function downloadCurrentDictionary() {
						if (!currentDictionary) {
						statusDiv.textContent = 'No dictionary loaded to download';
						return;
						}
						
						// Update metadata before download
						currentDictionary.metadata.downloaded = new Date().toISOString();
						
						const data = JSON.stringify(currentDictionary, null, 2);
						const blob = new Blob([data], { type: 'application/json' });
						const url = URL.createObjectURL(blob);
						const a = document.createElement('a');
						a.href = url;
						a.download = `dictionary-${currentDictionary.metadata.language}-${new Date().toISOString().slice(0, 10)}.json`;
						document.body.appendChild(a);
						a.click();
						setTimeout(() => {
						document.body.removeChild(a);
						URL.revokeObjectURL(url);
						}, 100);
						}
						
						// Clear current dictionary
						function clearCurrentDictionary() {
						if (!currentDictionary) {
						statusDiv.textContent = 'No dictionary loaded to clear';
						return;
						}
						
						const entryCount = Object.keys(currentDictionary.entries).length;
						if (!entryCount) {
						statusDiv.textContent = 'Dictionary is already empty';
						return;
						}
						
						if (confirm(`Clear all ${entryCount} entries in the ${currentDictionary.metadata.language} dictionary?`)) {
						currentDictionary.entries = {};
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = 'Dictionary cleared';
						}
						}
						
						// Upload dictionary and merge with current
						function uploadDictionary() {
						const input = document.createElement('input');
						input.type = 'file';
						input.accept = '.json';
						
						input.onchange = e => {
						const file = e.target.files[0];
						if (!file) return;
						
						const reader = new FileReader();
						
						reader.onload = function(e) {
						try {
						const newDict = JSON.parse(e.target.result);
						
						// Validate dictionary structure
						if (!newDict.metadata || !newDict.metadata.language || !newDict.entries) {
						throw new Error('Invalid dictionary format');
						}
						
						const outputDiv = document.getElementById('dictionary-manager-dictionaryOutput');
						
						if (!currentDictionary) {
						// Create new dictionary if none exists
						currentDictionary = newDict;
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = `Uploaded dictionary for ${newDict.metadata.language} with ${Object.keys(newDict.entries).length} entries`;
						return;
						}
						
						// Handle language mismatch
						if (currentDictionary.metadata.language !== newDict.metadata.language) {
						if (!confirm(`Current dictionary is for ${currentDictionary.metadata.language}, but uploaded file is for ${newDict.metadata.language}. Load as new dictionary?`)) {
						return;
						}
						currentDictionary = newDict;
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = `Loaded dictionary for ${newDict.metadata.language}`;
						return;
						}
						
						// Show merge preview
						let addedCount = 0;
						let updatedCount = 0;
						const conflicts = [];
						
						for (const [key, value] of Object.entries(newDict.entries)) {
						if (!currentDictionary.entries[key]) {
						addedCount++;
						} else if (currentDictionary.entries[key] !== value) {
						updatedCount++;
						conflicts.push({key, oldValue: currentDictionary.entries[key], newValue: value});
						}
						}
						
						const conflictInfo = conflicts.length ? 
						`<div class="dictionary-manager-merge-info">
							<strong>Note:</strong> ${conflicts.length} entries have different values in the uploaded dictionary
						</div>` : '';
						
						outputDiv.innerHTML = `
						<div class="dictionary-manager-summary">
							Merge Preview: ${addedCount} new entries, ${updatedCount} updates
						</div>
						${conflictInfo}
						<div class="dictionary-manager-button-group" style="margin-top:15px;">
							<button id="confirm-merge" class="dictionary-manager-btn dictionary-manager-btn-primary">Confirm Merge</button>
							<button id="cancel-merge" class="dictionary-manager-btn dictionary-manager-btn-light">Cancel</button>
						</div>
						`;
						
						document.getElementById('confirm-merge').addEventListener('click', () => {
						// Perform actual merge
						for (const [key, value] of Object.entries(newDict.entries)) {
						currentDictionary.entries[key] = value;
						}
						
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = `Merged dictionary: Added ${addedCount} entries, updated ${updatedCount}`;
						});
						
						document.getElementById('cancel-merge').addEventListener('click', () => {
						renderDictionary(currentDictionary);
						statusDiv.textContent = 'Merge canceled';
						});
						
						} catch (error) {
						statusDiv.textContent = 'Error: Invalid dictionary file';
						console.error('Dictionary upload error:', error);
						}
						};
						
						reader.onerror = () => {
						statusDiv.textContent = 'Error reading file';
						};
						
						reader.readAsText(file);
						};
						
						input.click();
						}
						
						// Update the renderMatches function to include manual correction
						function renderMatches(matches, dictionary, entries) {
						const outputDiv = document.getElementById('dictionary-manager-dictionaryOutput');
						outputDiv.innerHTML = '';
						
						const matchesContainer = document.createElement('div');
						matchesContainer.className = 'dictionary-manager-matches';
						matchesContainer.innerHTML = `
						<h3>Dictionary Conflicts Found</h3>
						<p>${matches.length} entries conflict with existing dictionary values</p>
						<div class="dictionary-manager-matches-container"></div>
						`;
						
						const container = matchesContainer.querySelector('.dictionary-manager-matches-container');
						
						for (const match of matches) {
						const matchDiv = document.createElement('div');
						matchDiv.className = 'dictionary-manager-match';
						matchDiv.innerHTML = `
						<div class="dictionary-manager-match-header">
							<strong>${match.msgid}</strong>
						</div>
						<div class="dictionary-manager-match-options">
							<div class="dictionary-manager-match-option">
								<label>
									<input type="radio" name="${match.msgid}" value="existing" checked>
									Use existing: 
								</label>
								<div class="dictionary-manager-match-value">${match.existing}</div>
							</div>
							<div class="dictionary-manager-match-option">
								<label>
									<input type="radio" name="${match.msgid}" value="new">
									Use new: 
								</label>
								<div class="dictionary-manager-match-value">${match.new}</div>
							</div>
							<div class="dictionary-manager-match-option">
								<label>
									<input type="radio" name="${match.msgid}" value="custom">
									Custom value:
								</label>
								<textarea class="dictionary-manager-custom-value" 
								rows="2" 
								placeholder="Enter custom translation..."
								data-msgid="${match.msgid}"></textarea>
							</div>
						</div>
						`;
						container.appendChild(matchDiv);
						}
						
						// Add event listeners to enable/disable textareas
						container.querySelectorAll('input[type="radio"]').forEach(radio => {
						radio.addEventListener('change', function() {
						const textarea = this.closest('.dictionary-manager-match-option')
						.querySelector('.dictionary-manager-custom-value');
						if (this.value === 'custom') {
						textarea.disabled = false;
						textarea.focus();
						} else {
						textarea.disabled = true;
						}
						});
						});
						
						const confirmBtn = document.createElement('button');
						confirmBtn.textContent = 'Confirm Selections';
						confirmBtn.id = 'dictionary-manager-confirmBtn';
						confirmBtn.className = 'dictionary-manager-btn dictionary-manager-btn-primary';
						
						confirmBtn.addEventListener('click', () => {
						container.querySelectorAll('.dictionary-manager-match').forEach(match => {
						const msgid = match.querySelector('strong').textContent;
						const selectedOption = match.querySelector('input[type="radio"]:checked').value;
						
						if (selectedOption === 'existing') {
						// Keep existing value
						} else if (selectedOption === 'new') {
						dictionary.entries[msgid] = matches.find(m => m.msgid === msgid).new;
						} else if (selectedOption === 'custom') {
						const customValue = match.querySelector('.dictionary-manager-custom-value').value;
						if (customValue.trim()) {
						dictionary.entries[msgid] = customValue;
						}
						}
						});
						
						const addedCount = filterAndAddEntries(dictionary, entries);
						localStorage.setItem(`dictionary-${dictionary.metadata.language}`, JSON.stringify(dictionary));
						renderDictionary(dictionary);
						statusDiv.textContent = `Resolved ${matches.length} conflicts and added ${addedCount} new entries`;
						matchesContainer.remove();
						});
						
						matchesContainer.appendChild(confirmBtn);
						outputDiv.appendChild(matchesContainer);
						}
						// Function to count words in a string
						function countWords(str) {
						return str.trim().split(/\s+/).filter(word => word.length > 0).length;
						}
						
						// Function to filter and add entries to dictionary
						function filterAndAddEntries(dictionary, entries) {
						const wordCountSetting = document.getElementById('dictionary-manager-wordCount').value;
						let addedCount = 0;
						
						entries.forEach(entry => {
						if (!entry.msgid) return;
						
						const wordCount = countWords(entry.msgid);
						const isSingleWord = wordCount === 1;
						const isTwoWords = wordCount === 2;
						
						let shouldAdd = false;
						
						if (wordCountSetting === "1" && isSingleWord) {
						shouldAdd = true;
						} else if (wordCountSetting === "2" && isTwoWords) {
						shouldAdd = true;
						} else if (wordCountSetting === "both" && (isSingleWord || isTwoWords)) {
						shouldAdd = true;
						}
						
						if (shouldAdd && !dictionary.entries[entry.msgid]) {
						dictionary.entries[entry.msgid] = entry.msgstr;
						addedCount++;
						}
						});
						
						return addedCount;
						}
						// Function to handle new entry creation
						function addNewEntry() {
						if (!currentDictionary) {
						statusDiv.textContent = 'Please load a dictionary first';
						return;
						}
						
						const outputDiv = document.getElementById('dictionary-manager-dictionaryOutput');
						
						// Create new entry form
						const newEntryForm = document.createElement('div');
						newEntryForm.className = 'dictionary-manager-new-entry-form';
						newEntryForm.innerHTML = `
						<div class="dictionary-manager-summary">Add New Dictionary Entry</div>
						<div class="dictionary-manager-new-entry-fields">
							<div class="dictionary-manager-input-box">
								<label class="dictionary-manager-label">Key:</label>
								<input type="text" id="dictionary-manager-newEntryKey" class="dictionary-manager-input">
							</div>
							<div class="dictionary-manager-input-box">
								<label class="dictionary-manager-label">Value:</label>
								<textarea id="dictionary-manager-newEntryValue" class="dictionary-manager-textarea" rows="3"></textarea>
							</div>
							<div class="dictionary-manager-button-group">
								<button id="dictionary-manager-saveNewEntry" class="dictionary-manager-btn dictionary-manager-btn-primary">Save</button>
								<button id="dictionary-manager-cancelNewEntry" class="dictionary-manager-btn dictionary-manager-btn-light">Cancel</button>
							</div>
						</div>
						`;
						
						outputDiv.prepend(newEntryForm);
						
						// Focus on key input
						document.getElementById('dictionary-manager-newEntryKey').focus();
						
						// Add event listeners
						document.getElementById('dictionary-manager-saveNewEntry').addEventListener('click', saveNewEntry);
						document.getElementById('dictionary-manager-cancelNewEntry').addEventListener('click', () => {
						newEntryForm.remove();
						});
						}
						
						function saveNewEntry() {
						const keyInput = document.getElementById('dictionary-manager-newEntryKey');
						const valueInput = document.getElementById('dictionary-manager-newEntryValue');
						const key = keyInput.value.trim();
						const value = valueInput.value.trim();
						
						if (!key) {
						statusDiv.textContent = 'Error: Key cannot be empty';
						keyInput.focus();
						return;
						}
						
						if (!value) {
						statusDiv.textContent = 'Error: Value cannot be empty';
						valueInput.focus();
						return;
						}
						
						if (currentDictionary.entries[key]) {
						if (!confirm(`An entry for "${key}" already exists. Overwrite it?`)) {
						return;
						}
						}
						
						currentDictionary.entries[key] = value;
						saveCurrentDictionary();
						renderDictionary(currentDictionary);
						statusDiv.textContent = `Added new entry: ${key.substring(0, 30)}${key.length > 30 ? '...' : ''}`;
						}
						
						// Function to filter dictionary entries
						function filterDictionary() {
						if (!currentDictionary) return;
						
						const searchInput = document.getElementById('dictionary-manager-searchInput').value.toLowerCase();
						const filterValue = document.getElementById('dictionary-manager-filterSelect').value;
						
						const rows = document.querySelectorAll('#dictionary-manager-dictionaryOutput tr[data-key]');
						
						rows.forEach(row => {
						const key = decodeURIComponent(row.dataset.key).toLowerCase();
						let shouldShow = true;
						
						// Apply search filter
						if (searchInput && !key.includes(searchInput)) {
						shouldShow = false;
						}
						
						// Apply alphabetical filter
						if (shouldShow && filterValue !== 'all') {
						const firstChar = key.charAt(0).toLowerCase();
						
						switch(filterValue) {
						case 'a-c': shouldShow = firstChar >= 'a' && firstChar <= 'c'; break;
						case 'd-f': shouldShow = firstChar >= 'd' && firstChar <= 'f'; break;
							case 'g-i': shouldShow = firstChar >= 'g' && firstChar <= 'i'; break;
								case 'j-l': shouldShow = firstChar >= 'j' && firstChar <= 'l'; break;
									case 'm-o': shouldShow = firstChar >= 'm' && firstChar <= 'o'; break;
										case 'p-r': shouldShow = firstChar >= 'p' && firstChar <= 'r'; break;
											case 's-u': shouldShow = firstChar >= 's' && firstChar <= 'u'; break;
												case 'v-z': shouldShow = firstChar >= 'v' && firstChar <= 'z'; break;
													}
													}
													
													if (shouldShow) {
													row.classList.remove('dictionary-manager-entry-hidden');
													} else {
													row.classList.add('dictionary-manager-entry-hidden');
													}
													});
													
													// Update status with visible count
													const visibleCount = document.querySelectorAll('#dictionary-manager-dictionaryOutput tr[data-key]:not(.dictionary-manager-entry-hidden)').length;
													const totalCount = Object.keys(currentDictionary.entries).length;
													document.querySelector('.dictionary-manager-summary').textContent = 
													`Dictionary: ${currentDictionary.metadata.language} | Showing ${visibleCount} of ${totalCount} entries`;
													}
													processBtn.addEventListener('click', async () => {
														statusDiv.textContent = 'Processing...';
														
														try {
														const content = await getPoContent();
														if (!content) {
														statusDiv.textContent = 'Error: No .po content found';
														return;
														}
														
														const { header } = extractHeader(content);
														const languageLine = extractLanguageLine(header);
														
														if (!languageLine) {
														statusDiv.textContent = 'Error: No language found in PO header';
														return;
														}
														
														const languagePo = cleanLanguageCode(languageLine);
														const selectedLanguage = document.getElementById('dictionary-manager-language').value;
														
														if (languagePo !== selectedLanguage) {
														const warning = `Warning: PO language (${languagePo}) doesn't match selected language (${selectedLanguage})`;
														console.warn(warning);
														statusDiv.textContent = warning;
														return;
														}
														
														console.log(`Language validation passed: ${languagePo} === ${selectedLanguage}`);
														statusDiv.textContent = 'Language validation passed. Checking dictionary...';
														
														// Step 3: Check for existing dictionary container
														const dictionaryKey = `dictionary-${languagePo}`;
														let dictionary = JSON.parse(localStorage.getItem(dictionaryKey));
														
														if (dictionary) {
														console.log(`Found existing dictionary for ${languagePo}`);
														statusDiv.textContent = `Loaded existing dictionary for ${languagePo}`;
														} else {
														console.log(`Creating new dictionary for ${languagePo}`);
														dictionary = createDictionaryContainer(languagePo);
														statusDiv.textContent = `Created new dictionary for ${languagePo}`;
														}
														
														// Render the dictionary
														renderDictionary(dictionary);
														console.log('Dictionary displayed in output area');
														currentDictionary = dictionary;
														
														
														const entries = parsePoEntries(content);
														
														// STEP 4: Handle dictionary matches
														const matches = processDictionaryMatches(dictionary, entries);
														if (matches.length > 0) {
														renderMatches(matches, dictionary, entries);  // Modified function
														statusDiv.textContent = `Found ${matches.length} dictionary matches - review below`;
														return;  // Pause process until user confirms
														}
														
														// STEP 5: Proceed if no matches found
														const addedCount = filterAndAddEntries(dictionary, entries);
														localStorage.setItem(`dictionary-${languagePo}`, JSON.stringify(dictionary));
														renderDictionary(dictionary);
														statusDiv.textContent = `Added ${addedCount} new entries`;
														} catch (error) {
														statusDiv.textContent = `Error: ${error.message}`;
														}
														});
														loadBtn.addEventListener('click', loadDictionary);
														saveDictBtn.addEventListener('click', () => {
														if (currentDictionary) {
														saveCurrentDictionary();
														} else {
														statusDiv.textContent = 'No dictionary loaded to save';
														}
														});
														downloadBtn.addEventListener('click', downloadCurrentDictionary);
														clearDictBtn.addEventListener('click', clearCurrentDictionary);
														uploadDictBtn.addEventListener('click', uploadDictionary);
														document.getElementById('dictionary-manager-newEntryBtn').addEventListener('click', addNewEntry);
														document.getElementById('dictionary-manager-searchInput').addEventListener('input', filterDictionary);
														document.getElementById('dictionary-manager-filterSelect').addEventListener('change', filterDictionary);
														// Enable dictionary buttons
														downloadBtn.disabled = false;
														function escapePoString(str) {
														return str.replace(/\\/g, '\\\\').replace(/"/g, '\\"').replace(/\n/g, '\\n');
														}
														
														function replaceMsgstrInBlock(block, newMsgstr) {
														const escapedMsgstr = escapePoString(newMsgstr);
														if (block.includes('msgstr "')) {
														return block.replace(/msgstr\s+"([^"]*)"/, `msgstr "${escapedMsgstr}"`);
														}
														if (block.includes('#~ msgstr "')) {
														return block.replace(/#~ msgstr\s+"([^"]*)"/, `#~ msgstr "${escapedMsgstr}"`);
														}
														return block;
														}
														
														async function applyDictionary() {
														statusDiv.textContent = 'Applying dictionary...';
														
														try {
														const content = await getPoContent();
														if (!content) {
														statusDiv.textContent = 'Error: No .po content found';
														return;
														}
														
														// Store original content before any changes
														originalPoContent = content;
														const language = document.getElementById('dictionary-manager-language').value;
														const dictKey = `dictionary-${language}`;
														const storedDict = localStorage.getItem(dictKey);
														const containerExists = storedDict !== null;
														
														console.log(`Dictionary container exists: ${containerExists}`);
														
														// Clear previous suggestions
														const suggestionsOutput = document.getElementById('dictionary-manager-suggestionsOutput');
														suggestionsOutput.innerHTML = '';
														
														// Split content into blocks
														const blocks = content.split(/\n\n/);
														let modifiedBlocks = [...blocks];
														let matches = [];
														
														if (containerExists) {
														const dictionary = JSON.parse(storedDict);
														const applyMode = document.getElementById('dictionary-manager-applyMode').value;
														
														// Process each block
														for (let i = 0; i < blocks.length; i++) {
														const block = blocks[i];
														const { msgid, msgstr } = parsePoBlock(block);
														
														if (msgid && dictionary.entries[msgid]) {
														const dictValue = dictionary.entries[msgid];
														matches.push({
														index: i,
														msgid: msgid,
														original: msgstr || '',
														dictionary: dictValue
														});
														
														// Auto-apply mode: replace immediately
														if (applyMode === 'auto') {
														modifiedBlocks[i] = replaceMsgstrInBlock(block, dictValue);
														}
														}
														}
														
														console.log(`Found ${matches.length} dictionary matches`);
														
														if (matches.length > 0) {
															// Suggest mode: show comparison with selection options
															if (applyMode === 'suggest') {
															// Build suggestions table
															let tableHTML = `
															<table class="dictionary-manager-suggestions-table">
																<thead>
																	<tr>
																		<th>Key (msgid)</th>
																		<th>Original Translation</th>
																		<th>Dictionary Value</th>
																		<th>Action</th>
																	</tr>
																</thead>
																<tbody>
																	`;
																	
																	matches.forEach(match => {
																	tableHTML += `
																	<tr>
																		<td>${match.msgid}</td>
																		<td>${match.original}</td>
																		<td>${match.dictionary}</td>
																		<td>
																			<label>
																				<input type="radio" name="action-${match.index}" value="original" checked>
																				Keep Original
																			</label>
																			<label>
																				<input type="radio" name="action-${match.index}" value="dictionary">
																				Use Dictionary
																			</label>
																		</td>
																	</tr>
																	`;
																	});
																	
																tableHTML += `</tbody></table>
																<div class="dictionary-manager-button-group" style="margin-top:15px;">
																	<button id="confirm-changes" class="dictionary-manager-btn dictionary-manager-btn-primary">Confirm Changes</button>
																</div>`;
																
																suggestionsOutput.innerHTML = tableHTML;
																
																// Add event listener for confirm button
																document.getElementById('confirm-changes').addEventListener('click', () => {
																// Apply selected changes
																matches.forEach(match => {
																const selectedAction = document.querySelector(`input[name="action-${match.index}"]:checked`).value;
																if (selectedAction === 'dictionary') {
																modifiedBlocks[match.index] = replaceMsgstrInBlock(
																blocks[match.index], 
																match.dictionary
																);
																}
																});
																
																// Update output
																const outputDiv = document.getElementById('dictionary-manager-applicationOutput');
																outputDiv.textContent = modifiedBlocks.join('\n\n');
																
																statusDiv.textContent = `Applied ${matches.length} changes to .po file`;
																});
																} else { // auto mode
																suggestionsOutput.innerHTML = `
																<div class="dictionary-manager-summary">
																	${matches.length} dictionary matches found and applied
																</div>
																`;
																}
																} else {
																suggestionsOutput.innerHTML = `
																<div class="dictionary-manager-summary">
																	No dictionary matches found in .po file
																</div>
																`;
																}
																}
																
																// Update output
																const outputDiv = document.getElementById('dictionary-manager-applicationOutput');
																outputDiv.textContent = modifiedBlocks.join('\n\n');
																
																statusDiv.textContent = `Applied dictionary to .po file (Container exists: ${containerExists})`;
																} catch (error) {
																statusDiv.textContent = `Error: ${error.message}`;
																}
																}
																
																function parsePoBlock(block) {
																let msgid = null;
																let msgstr = null;
																
																// Try to match msgid
																const msgidMatch = block.match(/(?:#~ *)?msgid\s+"(.*?[^\\])"/);
																if (msgidMatch) {
																msgid = msgidMatch[1].replace(/\\"/g, '"').trim();
																}
																
																// Try to match msgstr
																const msgstrMatch = block.match(/(?:#~ *)?msgstr\s+"(.*?[^\\])"/);
																if (msgstrMatch) {
																msgstr = msgstrMatch[1].replace(/\\"/g, '"').trim();
																}
																
																return { msgid, msgstr };
																}
																
																async function downloadModifiedPo() {
																const outputDiv = document.getElementById('dictionary-manager-applicationOutput');
																const modifiedContent = outputDiv.textContent;
																
																if (!modifiedContent) {
																statusDiv.textContent = 'Error: No modified content to download';
																return;
																}
																
																// Compare line counts using stored original content
																const originalLines = originalPoContent ? originalPoContent.split('\n').length : 0;
																const modifiedLines = modifiedContent.split('\n').length;
																
																console.log(`Line count comparison - Original: ${originalLines}, Modified: ${modifiedLines}`);
																statusDiv.textContent = `Line count: Original ${originalLines}, Modified ${modifiedLines} (difference: ${Math.abs(originalLines - modifiedLines)})`;
																
																// Determine file name
																let fileName = 'modified_dictionary.po';
																if (fileInput.files.length > 0) {
																const originalName = fileInput.files[0].name;
																fileName = originalName.replace('.po', '_modified.po');
																}
																
																// Create and trigger download
																const blob = new Blob([modifiedContent], { type: 'text/plain;charset=utf-8' });
																const url = URL.createObjectURL(blob);
																const a = document.createElement('a');
																a.href = url;
																a.download = fileName;
																document.body.appendChild(a);
																a.click();
																
																// Clean up
																setTimeout(() => {
																document.body.removeChild(a);
																URL.revokeObjectURL(url);
																}, 100);
																}
																
																});
														</script>
													</body>
												</html>																								